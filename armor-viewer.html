<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Minecraft Armor Viewer</title>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
  body { margin:0; background:#111; color:#fff; font-family:sans-serif; }
  canvas { display:block; }
  #upload-area { position:absolute; top:10px; left:10px; padding:10px; border:2px dashed #fff; cursor:pointer; background:rgba(0,0,0,0.5);}
</style>
</head>
<body>

<div id="upload-area">Upload Pack (.zip or .mcpack)</div>
<input type="file" id="file-input" style="display:none;" accept=".zip,.mcpack">

<script>
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

let camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(5,6,10);
camera.lookAt(0,3,0);

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Lights
scene.add(new THREE.AmbientLight(0xffffff,0.5));
let dirLight = new THREE.DirectionalLight(0xffffff,1);
dirLight.position.set(10,10,10);
scene.add(dirLight);

// Armor group
let armor = new THREE.Group();
scene.add(armor);

// Create cubes for armor pieces
function createCube(w,h,d,x,y,z,material){
  let mesh = new THREE.Mesh(new THREE.BoxGeometry(w,h,d), material);
  mesh.position.set(x,y,z);
  return mesh;
}

let defaultMat = new THREE.MeshBasicMaterial({color:0x5555ff});
let pieces = {
  head: createCube(1,1,1,0,4.5,0,defaultMat),
  body: createCube(1.5,2,1,0,3,0,defaultMat),
  leftArm: createCube(0.5,2,0.5,-1.25,3,0,defaultMat),
  rightArm: createCube(0.5,2,0.5,1.25,3,0,defaultMat),
  leftLeg: createCube(0.5,2,0.5,-0.5,1,0,defaultMat),
  rightLeg: createCube(0.5,2,0.5,0.5,1,0,defaultMat),
};
Object.values(pieces).forEach(p=>armor.add(p));

// Texture loader
const loader = new THREE.TextureLoader();

// Orbit control-like drag
let isDragging=false, prevPos={x:0,y:0};
renderer.domElement.addEventListener('mousedown',e=>isDragging=true);
renderer.domElement.addEventListener('mouseup',e=>isDragging=false);
renderer.domElement.addEventListener('mousemove',e=>{
  if(!isDragging) return;
  let delta = {x:e.offsetX-prevPos.x, y:e.offsetY-prevPos.y};
  armor.rotation.y += delta.x*0.01;
  armor.rotation.x += delta.y*0.01;
  prevPos = {x:e.offsetX, y:e.offsetY};
});
renderer.domElement.addEventListener('mousedown', e=> prevPos={x:e.offsetX,y:e.offsetY});

// Animate
function animate(){requestAnimationFrame(animate); renderer.render(scene,camera);}
animate();

// Handle file uploads
const uploadArea = document.getElementById('upload-area');
const fileInput = document.getElementById('file-input');

uploadArea.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change', e => handleFile(e.target.files[0]));
uploadArea.addEventListener('dragover', e=>{e.preventDefault(); uploadArea.style.borderColor='#00f';});
uploadArea.addEventListener('dragleave', e=>{uploadArea.style.borderColor='#fff';});
uploadArea.addEventListener('drop', e=>{e.preventDefault(); handleFile(e.dataTransfer.files[0]);});

function handleFile(file){
  if(!file) return;
  JSZip.loadAsync(file).then(zip=>{
    // Look for standard armor textures
    const armorFiles = {
      head: ['netherite_layer_1.png','diamond_layer_1.png','iron_layer_1.png','gold_layer_1.png','chainmail_layer_1.png','leather_layer_1.png','turtle_layer_1.png'],
      body: ['netherite_layer_1.png','diamond_layer_1.png','iron_layer_1.png','gold_layer_1.png','chainmail_layer_1.png','leather_layer_1.png','turtle_layer_1.png'],
      legs: ['netherite_layer_2.png','diamond_layer_2.png','iron_layer_2.png','gold_layer_2.png','chainmail_layer_2.png','leather_layer_2.png'],
      boots: ['netherite_layer_1.png','diamond_layer_1.png','iron_layer_1.png','gold_layer_1.png','chainmail_layer_1.png','leather_layer_1.png','turtle_layer_1.png']
    };

    Object.keys(pieces).forEach(part=>{
      let found = null;
      for(let p of armorFiles[part==='leftLeg'||part==='rightLeg'?'legs':part==='leftFoot'||part==='rightFoot'?'boots':part]){
        let fileEntry = zip.file(new RegExp(p.replace(/_/g,'_'),'i'));
        if(fileEntry){
          found = fileEntry;
          break;
        }
      }
      if(found){
        found.async('blob').then(blob=>{
          const url = URL.createObjectURL(blob);
          loader.load(url, tex=>{
            tex.magFilter = THREE.NearestFilter;
            tex.minFilter = THREE.NearestFilter;
            pieces[part].material.map = tex;
            pieces[part].material.needsUpdate = true;
          });
        });
      }
    });
  });
}
</script>
</body>
</html>
