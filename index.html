<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BedrockHub — Texture Packs</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<style>
:root{
  --bg-0:#060910;--bg-1:#0a0f1a;--bg-2:#0e1524;--glass:rgba(255,255,255,.04);
  --muted:#a8b3cf;--text:#e8eefc;--border:rgba(255,255,255,.08);
  --brand-1:#7c3aed;--brand-2:#2563eb;--brand-3:#22d3ee;
  --shadow:0 24px 70px rgba(0,0,0,.55);
}
*{box-sizing:border-box;}
html,body{height:100%;margin:0;font:500 15px/1.6 Inter, sans-serif;color:var(--text);}
body{background:radial-gradient(1200px 800px at 10% -10%,rgba(124,58,237,.18),transparent),radial-gradient(1200px 800px at 90% 10%,rgba(37,99,235,.18),transparent),linear-gradient(180deg,var(--bg-1),var(--bg-0) 40%,var(--bg-1));}
a{color:inherit;text-decoration:none;}
header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(1.2) blur(10px);background:linear-gradient(90deg,rgba(255,255,255,.02),rgba(255,255,255,.01));border-bottom:1px solid var(--border);}
.nav{max-width:1200px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;}
.brand{display:flex;align-items:center;gap:.8rem;}
.brand-badge{height:44px;width:44px;border-radius:12px;display:grid;place-items:center;background:linear-gradient(135deg,var(--brand-2),var(--brand-1));box-shadow:0 12px 30px rgba(124,58,237,.22);}
.brand-title{font-weight:800;letter-spacing:.6px;}
.nav-actions{display:flex;gap:.6rem;}
.ghost{border:1px solid var(--border);background:transparent;color:var(--text);}
.btn{padding:.45rem .7rem;border-radius:10px;font-weight:700;display:inline-flex;align-items:center;gap:.55rem;cursor:pointer;}
.primary{background:linear-gradient(90deg,var(--brand-1),var(--brand-2));box-shadow:0 10px 30px rgba(124,58,237,.22);}
.container{max-width:1200px;margin:0 auto;padding:28px 18px;}
.card{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.02));border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);}
.packs{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;}
.pack .thumb{height:140px;border-bottom:1px solid var(--border);background:linear-gradient(135deg,#1f2937,#0f172a);display:flex;align-items:center;justify-content:center;}
.pack .glyph{height:68px;width:68px;border-radius:14px;display:grid;place-items:center;color:white;}
.pack .content{padding:14px;}
.pack h4{margin:0 0 4px 0;font-size:18px;}
.meta{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 12px;}
.actions{display:flex;gap:8px;}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,.6);display:none;align-items:center;justify-content:center;z-index:60;}
.modal{width:100%;max-width:760px; background: var(--bg-2); border-radius:18px;}
.modal .panel{padding:20px;}
.file-upload-area { display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;border:2px dashed var(--border);border-radius:12px;background:rgba(255,255,255,.02);cursor:pointer;transition:all .3s;}
.file-upload-area:hover { border-color: var(--brand-1); background: rgba(124,58,237,.05);}
.file-upload-area i {font-size:32px;margin-bottom:12px;color: var(--brand-1);}
.file-hint { margin-top:6px; color: var(--muted); }
input,textarea{width:100%;padding:.6rem;margin-bottom:8px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.02);color:white;}
</style>
</head>
<body>
<header>
<div class="nav">
  <a class="brand" href="#"><div class="brand-badge"><i class="fa-solid fa-cube"></i></div><div><div class="brand-title">BEDROCKHUB</div><div class="tiny">Minecraft Bedrock • community</div></div></a>
  <div class="nav-actions">
    <button class="btn ghost" onclick="fetchPacks()">Refresh</button>
    <button class="btn primary" onclick="openModal()">Upload pack</button>
  </div>
</div>
</header>

<section class="container">
<div class="packs" id="packGrid"></div>
</section>

<div id="modal" class="modal-backdrop">
<div class="modal card">
<div class="panel">
<h3 id="modalTitle">Upload / Edit Pack</h3>
<input id="packName" placeholder="Pack name"/>
<input id="packTags" placeholder="Tags comma separated"/>
<div class="file-upload-area" onclick="document.getElementById('fileInput').click()">
<i class="fa-solid fa-file-arrow-up"></i>
<div>Click to upload .mcpack file</div>
<div class="file-hint">Max 50MB</div>
<input type="file" id="fileInput" style="display:none"/>
</div>
<div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
<button class="btn ghost" onclick="closeModal()">Cancel</button>
<button class="btn primary" onclick="handleUpload()">Save</button>
</div>
</div>
</div>
</div>

<script>
const modal=document.getElementById('modal');
let editingId=null;

function openModal(pack=null){
  modal.style.display='flex';
  if(pack){editingId=pack.id;document.getElementById('packName').value=pack.name;document.getElementById('packTags').value=pack.tags.join(',');} 
  else {editingId=null;document.getElementById('packName').value='';document.getElementById('packTags').value='';}
}

function closeModal(){modal.style.display='none';editingId=null;document.getElementById('fileInput').value='';}

async function fetchPacks(){
  const res=await fetch('/api/getpacks');
  const data=await res.json();
  const grid=document.getElementById('packGrid');
  grid.innerHTML='';
  data.forEach(p=>{
    const div=document.createElement('div');
    div.className='pack card';
    div.innerHTML=`
      <div class="thumb"><div class="glyph" style="background:#7c3aed"><i class="fa-solid fa-cubes"></i></div></div>
      <div class="content">
        <h4>${p.name}</h4>
        <div class="meta">${p.tags.map(t=>`<span class="badge">${t}</span>`).join('')}</div>
        <div class="actions">
          <a class="btn sm primary" href="${p.url}" download>Download</a>
          <button class="btn sm ghost" onclick='openModal(${JSON.stringify(p)})'>Edit</button>
        </div>
      </div>`;
    grid.appendChild(div);
  });
}

async function handleUpload(){
  const name=document.getElementById('packName').value;
  const tags=document.getElementById('packTags').value;
  const file=document.getElementById('fileInput').files[0];
  if(!name || !tags || (!file && !editingId)){alert('Fill all fields');return;}
  const form=new FormData();
  form.append('name',name);
  form.append('tags',tags);
  if(file) form.append('file',file);
  if(editingId) form.append('id',editingId);
  const res=await fetch('/api/addpacks', {method:'POST',body:form});
  if(res.ok){closeModal();fetchPacks();}
  else{alert('Upload failed');}
}

window.onload=fetchPacks;
</script>
</body>
</html>
